package utill;

import java.sql.*;
import java.util.ArrayList;

import model.Activity;
import model.Destination;
import model.Passenger;
import model.StandardPassenger;
import model.TravelPackage;
public class DataRetrieval {
	
	public static void retrieveDestinationsFromDatabase(Connection connection, TravelPackage travelPackage) throws SQLException {
        String sql = "SELECT destination_name FROM destinations WHERE travel_package_id = ?";
        try (PreparedStatement statement = connection.prepareStatement(sql)) {
            statement.setInt(1, travelPackage.getId()); 
            try (ResultSet resultSet = statement.executeQuery()) {
                while (resultSet.next()) {
                    String destinationName = resultSet.getString("destination_name");
                    Destination destination = new Destination(destinationName);

                    
                    retrieveActivitiesFromDatabase(connection, destination);

                    travelPackage.addDestination(destination);
                }
            }
        }
    }
	public static void retrieveActivitiesFromDatabase(Connection connection, Destination destination) throws SQLException {
	        String sql = "SELECT activity_name, description, cost, capacity FROM activities WHERE destination_id = ?";
	        try (PreparedStatement statement = connection.prepareStatement(sql)) {
	            statement.setInt(1, destination.getId()); 
	            try (ResultSet resultSet = statement.executeQuery()) {
	                while (resultSet.next()) {
	                    String activityName = resultSet.getString("activity_name");
	                    String description = resultSet.getString("description");
	                    double cost = resultSet.getDouble("cost");
	                    int capacity = resultSet.getInt("capacity");
	                    Activity activity = new Activity(activityName, description, cost, capacity);
	                    destination.addActivity(activity);
	                }
	            }
	        }
	    }
	
	 public static Passenger retrievePassengersFromDatabase(Connection connection, String pName,int pNumber) throws SQLException {
	        String sql = "SELECT * FROM passengers WHERE passenger_name = ? and passenger_number= ?";
	        Passenger passenger = null;
	        try (PreparedStatement statement = connection.prepareStatement(sql)) {
	            statement.setString(1,pName); 
	            statement.setInt(2,pNumber); 
	            
	            try (ResultSet resultSet = statement.executeQuery()) {
	                while (resultSet.next()) {
	                	passenger= new Passenger(resultSet.getString("passenger_name"),resultSet.getInt("passenger_number"));
	                    passenger.setPassengerType(resultSet.getString("passenger_type"));
	                    passenger.setWalletBalance(resultSet.getDouble("balance"));
	             
	      
	                }
	            }
	        }
	        return passenger;
	    }
	 public static TravelPackage retrieveTravelPackageFromDB(Connection connection) {
		 String sql = "select * from travel_packages";
		 ArrayList<TravelPackage>;
		 try(PreparedStatement stmt = connection.prepareStatement(sql)){
			 try(ResultSet resultSet = stmt.executeQuery()){
				 while(resultSet.next()) {
					 
				 }
			 }
		 }
	 }

	    

	  

}
